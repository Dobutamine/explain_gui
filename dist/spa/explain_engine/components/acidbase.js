brent_accuracy=1e-8,max_iterations=100,left_hp=1e3*Math.pow(10,-8),right_hp=1e3*Math.pow(10,-6),alpha_co2p=.03067,kw=1e3*Math.pow(10,-13.6),kc=1e3*Math.pow(10,-6.1),kd=1e3*Math.pow(10,-10.22),ph=0,pco2=0,tco2=0,tco2co2=0,cco2p=0,hco3p=0,co3p=0,ohp=0,be=0,alb_base=0,phos_base=0,ab_comp=null,calcPlasmaNetcharge=function(o){return ph=-Math.log10(o/1e3),tco2=ab_comp.tco2,tco2co2=1+kc/o+kc*kd/Math.pow(o,2),cco2p=ab_comp.tco2/tco2co2,hco3p=kc*cco2p/o,co3p=kd*hco3p/o,ohp=kw/o,alb_base=ab_comp.albumin*(.378/(1+Math.pow(10,7.1-ph))),phos_base=ab_comp.phosphates/(1+Math.pow(10,6.8-ph)),pco2=cco2p/alpha_co2p,be=(hco3p-24.4+(2.3*ab_comp.hemoglobin+7.7)*(ph-7.4))*(1-.023*ab_comp.hemoglobin),o+ab_comp.sid-hco3p-2*co3p-ohp-alb_base-phos_base-ab_comp.uma},calcAcidbaseFromTCO2=function(o,c){return ab_comp={tco2:o.tco2,hemoglobin:o["hemoglobin"],albumin:o["albumin"],phosphates:o["phosphates"],uma:o["uma"],sid:o["sid"]},result=brent(calcPlasmaNetcharge,left_hp,right_hp,brent_accuracy,max_iterations),result.error?console.log("error in acidbase calcuations"):(o.ph=ph,o.pco2=pco2,o.cco2p=cco2p,o.tco2=tco2,o.hco3p=hco3p,o.be=be),result};